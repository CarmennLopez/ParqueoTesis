# Variables de entorno para el Sistema de Parqueo UMG - Enterprise Edition
# Copiar este archivo a .env y ajustar los valores según tu entorno

# ========================================
# SERVIDOR
# ========================================
PORT=3000
NODE_ENV=development

# ========================================
# BASE DE DATOS - MONGODB
# ========================================
# MongoDB URI - Desarrollo local
MONGODB_URI=mongodb://localhost:27017/parqueo_umg

# MongoDB URI - Ejemplo para MongoDB Atlas (producción)
# MONGODB_URI=mongodb+srv://usuario:contraseña@cluster.mongodb.net/parqueo_umg?retryWrites=true&w=majority

# ========================================
# REDIS (Caché y Sesiones)
# ========================================
# Redis Local (Memurai en Windows, Redis en Linux/Mac)
REDIS_URL=redis://localhost:6379

# Redis con autenticación (producción)
# REDIS_URL=redis://:tu_password@localhost:6379

# Redis Cluster (producción avanzada)
# REDIS_CLUSTER_NODES=redis-node1:6379,redis-node2:6379,redis-node3:6379

# ========================================
# AUTENTICACIÓN JWT
# ========================================
# Secreto para firmar tokens JWT (IMPORTANTE: usar valor aleatorio y seguro en producción)
# Generar con: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=tu_secreto_jwt_super_seguro_cambiar_en_produccion_64_caracteres_minimo

# Duración de Access Token (corta para seguridad)
JWT_EXPIRATION=15m

# Duración de Refresh Token (larga para UX móvil)
JWT_REFRESH_EXPIRATION=30d

# ========================================
# SEGURIDAD - CORS
# ========================================
# Orígenes permitidos (separados por comas)
# Desarrollo: Permitir localhost en varios puertos
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8100,http://localhost:4200

# Producción: Especificar dominios exactos de la UMG
# ALLOWED_ORIGINS=https://parking.umg.edu.gt,https://admin.parking.umg.edu.gt

# ========================================
# CONFIGURACIÓN DE PARQUEO
# ========================================
# Nombre del parqueo principal
PARKING_LOT_NAME=Parqueo Principal UMG

# ========================================
# INTEGRACIÓN IoT - MQTT (Barreras y Sensores)
# ========================================
# Broker MQTT Local (para desarrollo sin hardware)
MQTT_BROKER_URL=mqtt://localhost:1883

# Broker MQTT Producción (ejemplo: AWS IoT Core, Mosquitto en servidor)
# MQTT_BROKER_URL=mqtts://mqtt.umg.edu.gt:8883
# MQTT_USERNAME=umg_parking_client
# MQTT_PASSWORD=secure_password

# Modo Simulación (true = no conecta hardware real, solo logs)
MQTT_SIMULATION_MODE=true

# Topics MQTT
MQTT_TOPIC_GATE_COMMAND=backend/open_gate
MQTT_TOPIC_GATE_STATUS=hardware/gate_status
MQTT_TOPIC_LPR_EVENT=hardware/lpr/event

# ========================================
# FACTURACIÓN ELECTRÓNICA - FEL GUATEMALA
# ========================================
# Modo Simulación (true = genera facturas fake, no certifica)
FEL_SIMULATION_MODE=true

# Proveedor FEL (cuando SIMULATION_MODE=false)
# Opciones: INFILE_GUATEMALA, DIGIFACT, G4S, MEGAPRINT
FEL_PROVIDER=INFILE_GUATEMALA

# Credenciales FEL (producción)
# FEL_API_URL=https://api.infile.com.gt/v1
# FEL_API_KEY=tu_api_key_fel
# FEL_NIT_EMISOR=123456789
# FEL_ESTABLISHMENT_CODE=001

# ========================================
# LDAP / ACTIVE DIRECTORY UMG
# ========================================
# Modo Simulación (true = no conecta AD real, usa DB local)
LDAP_SIMULATION_MODE=true

# Configuración LDAP real (cuando SIMULATION_MODE=false)
# LDAP_SERVER_URL=ldap://ad.umg.edu.gt:389
# LDAPS_SERVER_URL=ldaps://ad.umg.edu.gt:636
# LDAP_BASE_DN=dc=umg,dc=edu,dc=gt
# LDAP_BIND_DN=cn=service_parking,ou=services,dc=umg,dc=edu,dc=gt
# LDAP_BIND_PASSWORD=password_del_servicio
# LDAP_SEARCH_FILTER=(|(carnetUMG={0})(mail={0}))

# ========================================
# LOGGING
# ========================================
# Nivel de logging: error, warn, info, http, debug
# Desarrollo: debug (muestra todo)
# Producción: info (solo información relevante)
LOG_LEVEL=debug

# Directorio de logs
LOG_DIR=./logs

# Rotación de archivos de log (producción)
LOG_MAX_SIZE=10m
LOG_MAX_FILES=14d

# ========================================
# RATE LIMITING
# ========================================
# Login: Máximo intentos antes de bloquear temporalmente
LOGIN_RATE_LIMIT_WINDOW_MS=900000
LOGIN_RATE_LIMIT_MAX_ATTEMPTS=5

# API General: Requests por ventana de tiempo
API_RATE_LIMIT_WINDOW_MS=60000
API_RATE_LIMIT_MAX_REQUESTS=100

# ========================================
# CACHÉ (Redis)
# ========================================
# TTL para caché de estado de parqueo (segundos)
CACHE_PARKING_STATUS_TTL=5

# TTL para caché de perfil de usuario (segundos)
CACHE_USER_PROFILE_TTL=300

# ========================================
# TARIFAS Y PLANES DE PAGO (Quetzales)
# ========================================
# Tarifa por hora para estudiantes/visitantes
RATE_HOURLY_STUDENT=10.00
RATE_HOURLY_VISITOR=15.00

# Suscripción mensual
RATE_MONTHLY_STUDENT=250.00
RATE_MONTHLY_FACULTY=150.00

# ========================================
# WEBSOCKETS (Socket.io)
# ========================================
# Puerto para WebSockets (mismo que HTTP si se usa Socket.io sobre Express)
WS_PORT=3000

# CORS para WebSockets (debe coincidir con frontend)
WS_ALLOWED_ORIGINS=http://localhost:8100,http://localhost:4200

# ========================================
# NOTIFICACIONES
# ========================================
# Email (futuro)
# SMTP_HOST=smtp.umg.edu.gt
# SMTP_PORT=587
# SMTP_USER=parking@umg.edu.gt
# SMTP_PASSWORD=password

# SMS Gateway (futuro)
# SMS_API_URL=https://api.twilio.com/v1
# SMS_API_KEY=tu_api_key

# ========================================
# GEOLOCALIZACIÓN (Multi-Sede)
# ========================================
# Coordenadas de sedes UMG (para índices geoespaciales)
# Campus Central: 14.634915, -90.506882
# Campus Portales: 14.628491, -90.518189
# CAMPUS_LOCATIONS=14.634915,-90.506882;14.628491,-90.518189

# ========================================
# NOTAS IMPORTANTES
# ========================================
# 1. NO subir este archivo con valores reales a control de versiones (.gitignore)
# 2. Crear un archivo .env basado en este ejemplo
# 3. En producción, cambiar TODOS los secrets y passwords
# 4. Establecer SIMULATION_MODE=false en producción para IoT/FEL/LDAP reales
# 5. Usar variables de entorno del servidor en lugar de .env en producción
# 6. Para generar JWT_SECRET seguro:
#    node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
